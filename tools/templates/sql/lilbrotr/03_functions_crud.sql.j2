{% extends "base/03_functions_crud.sql.j2" %}
{% block events_insert_body %}
    -- Store essential fields + compute tagvalues; tags/content/sig remain NULL
    INSERT INTO event (id, pubkey, created_at, kind, tagvalues)
    SELECT id, pubkey, created_at, kind, tags_to_tagvalues(tags)
    FROM unnest(p_event_ids, p_pubkeys, p_created_ats, p_kinds, p_tags)
        AS t(id, pubkey, created_at, kind, tags)
    ON CONFLICT (id) DO NOTHING;
{% endblock %}
