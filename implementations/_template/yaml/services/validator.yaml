# ============================================================================
# BigBrotr Implementation Template - Validator Service Configuration
# ============================================================================
# Description: Validate candidate relay URLs before adding to relays table
# Used by: src/services/validator.py
# Run mode: Continuous (runs every interval) or one-shot (--once flag)
# Dependencies: Seeder/Finder write candidates to service_data
# ============================================================================
#
# PURPOSE:
# The Validator service processes candidate relay URLs by:
# 1. Attempting WebSocket connection
# 2. Verifying relay protocol compliance (REQ/response test)
# 3. Adding valid relays to the relays table
# 4. Tracking failed attempts for retry/cleanup
#
# ============================================================================

# Cycle interval (seconds between validation runs)
# Range: >= 60.0
# Recommendation: 300-600 for production (5-10 minutes)
interval: 300.0

# Batch processing settings
batch:
  # WebSocket connection timeout (seconds)
  # Range: 0.1 - 60.0
  # Note: Tor relays may need longer timeouts
  timeout: 10.0

  # Maximum candidates to validate per cycle (optional)
  # Candidates with fewer failed attempts are prioritized
  # Uncomment to limit validation rate:
  # max_candidates: 100

# Concurrency settings
concurrency:
  # Number of worker processes for parallel validation
  # Range: 1 - 32
  # Use 1 for single-process mode (asyncio only)
  processes: 1

  # Concurrent tasks per process
  # Range: 1 - 100
  # Higher = faster validation but more memory and connections
  tasks: 10

# Cleanup settings for failed candidates
cleanup:
  enabled: false              # Enable automatic cleanup of max-attempt candidates
  max_attempts: 10            # Delete candidates after this many failures

# Network configuration for overlay networks
# Each network requires its own SOCKS5 proxy for connectivity
network:
  # Clearnet (regular internet) relays
  clearnet:
    enabled: true

  # Tor proxy for .onion relays
  tor:
    enabled: true
    proxy_url: "socks5://tor:9050"

  # I2P proxy for .i2p relays
  i2p:
    enabled: false
    proxy_url: "socks5://i2p:4447"

  # Lokinet proxy for .loki relays
  loki:
    enabled: false
    proxy_url: "socks5://lokinet:1080"

# ============================================================================
# CUSTOMIZATION NOTES
# ============================================================================
#
# NO TOR SUPPORT:
#   network.tor.enabled: false
#   (Remove tor dependency from docker-compose.yaml)
#
# MINIMAL RESOURCES:
#   interval: 600.0
#   batch.timeout: 5.0
#   concurrency.tasks: 5
#   batch.max_candidates: 50
#
# AGGRESSIVE VALIDATION:
#   interval: 120.0
#   concurrency.processes: 4
#   concurrency.tasks: 25
#
# SLOW NETWORK:
#   batch.timeout: 30.0
#
# ============================================================================
