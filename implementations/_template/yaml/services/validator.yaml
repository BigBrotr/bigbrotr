# ============================================================================
# Validator Service Configuration (Template)
# ============================================================================
# Validates candidate relay URLs before promoting to relays table.
# Workflow: cleanup → fetch chunk → validate in parallel → persist → repeat
#
# All values shown are DEFAULTS from the code. Modify only what you need.
# ============================================================================

# -----------------------------------------------------------------------------
# Base Service Settings (inherited from BaseServiceConfig)
# -----------------------------------------------------------------------------

# Seconds between validation cycles
# Range: >= 60.0
# Lower = more frequent validation, higher resource usage
interval: 300.0

# Stop service after this many consecutive cycle failures
# Set to 0 for unlimited retries
max_consecutive_failures: 5

# -----------------------------------------------------------------------------
# Prometheus Metrics
# -----------------------------------------------------------------------------

metrics:
  # Enable/disable metrics HTTP server
  enabled: true

  # HTTP port for /metrics endpoint
  # Each service needs a unique port (finder=8001, validator=8002, etc.)
  port: 8002

  # Bind address (0.0.0.0 for container environments)
  host: "0.0.0.0"

  # URL path for metrics endpoint
  path: "/metrics"

# -----------------------------------------------------------------------------
# Processing Settings
# -----------------------------------------------------------------------------

processing:
  # Number of candidates to process per chunk
  # Higher = fewer DB round-trips, more memory
  # Range: 10-1000
  chunk_size: 100

  # Maximum candidates to process per cycle
  # null = unlimited (process all available)
  # Set a limit for resource-constrained environments
  max_candidates: null

# -----------------------------------------------------------------------------
# Cleanup Settings
# -----------------------------------------------------------------------------

cleanup:
  # Remove candidates that exceeded max_failures
  # true = delete exhausted candidates
  # false = keep for analysis/debugging
  enabled: false

  # Number of failed validation attempts before removal (if enabled)
  # Range: 1-1000
  max_failures: 100

# -----------------------------------------------------------------------------
# Network Configuration
# -----------------------------------------------------------------------------
# Per-network settings for relay validation:
# - enabled: Process relays on this network
# - proxy_url: SOCKS5 proxy for overlay networks
# - max_tasks: Concurrent validation limit
# - timeout: WebSocket handshake timeout in seconds
# -----------------------------------------------------------------------------

networks:
  # Clearnet relays (wss://)
  clearnet:
    enabled: true
    max_tasks: 50
    timeout: 10.0

  # Tor .onion relays (requires Tor proxy)
  tor:
    enabled: true
    proxy_url: "socks5://tor:9050"
    max_tasks: 10
    timeout: 30.0

  # I2P .i2p relays (requires I2P router)
  i2p:
    enabled: false
    proxy_url: "socks5://i2p:4447"
    max_tasks: 5
    timeout: 45.0

  # Lokinet .loki relays (requires Lokinet, Linux only)
  loki:
    enabled: false
    proxy_url: "socks5://lokinet:1080"
    max_tasks: 5
    timeout: 30.0

# ============================================================================
# CUSTOMIZATION EXAMPLES
# ============================================================================
#
# MINIMAL RESOURCES (clearnet only, low frequency):
#   interval: 600.0
#   processing:
#     max_candidates: 200
#   networks:
#     clearnet:
#       max_tasks: 20
#     tor:
#       enabled: false
#
# AGGRESSIVE VALIDATION (high throughput):
#   interval: 120.0
#   processing:
#     chunk_size: 200
#   networks:
#     clearnet:
#       max_tasks: 100
#     tor:
#       max_tasks: 20
#
# CLEANUP EXHAUSTED CANDIDATES:
#   cleanup:
#     enabled: true
#     max_failures: 100
#
# ============================================================================
